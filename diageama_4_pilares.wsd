@startuml diagrama_4_pilares
' Protocol/Interface
interface Notificador {
    +enviar(mensaje: String): void
}

' Implementaciones del Protocol / Interface
class NotificadorEmail {
    -destinatario: String
    -servidor_smtp: String
    +__init__(destinatario: String, servidor: String)
    +enviar(mensaje: String): void
    +validar_email(): boolean
}

class NotificadorWebhook {
    -url: String
    -timeout: int
    +__init__(url: String, timeout: int)
    +enviar(mensaje: String): void
    +validar_url(): boolean
}

class NotificadorSMS {
    -numero: String
    -proveedor: String
    +__init__(numero: String, proveedor: String)
    +enviar(mensaje: String): void
    +formato_numero(): String
}

' Clase abstracta base para los sensores
abstract class Sensor{
    +id: String
    +ventana: int
    #calibracion: float
    #buffer: list[float]
    #ubicacion: String
    
    +__init__(id: String, ventana: int, ubicacion: String)
    +leer(valor: float): void
    +promedio(): float
    +obtener_estado(): String
    {abstract} +en_alerta(): boolean
    {abstract} +obtener_tipo(): String
}   

' HERENCIA: Subclases Concretas
class SensorTemperatura {
    -umbral_max: float
    -umbral_min: float
    -unidad: String
    
    +__init__(id: String, umbral_max: float, umbral_min: float)
    +en_alerta(): boolean
    +obtener_tipo(): String
    +celsius_to_fahrenheit(): float
}

class SensorVibracion {
    -rms_umbral: float
    -frecuencia: int
    
    +__init__(id: String, rms_umbral: float, frecuencia: int)
    +en_alerta(): boolean
    +obtener_tipo(): String
    +calcular_rms(): float
}

class SensorHumedad{
    -umbral_humedad: float
    -tipo_ambiente: String
    
    +__init__(id: String, umbral: float, ambiente: String)
    +en_alerta(): boolean
    +obtener_tipo(): String
    +calcular_punto_rocio(): float
}


' Composición - GestorAlertas contiene sensores y notificadores
class GestorAlertas {
    -sensores: list[Sensor]
    -notificador: list[Notificador]
    -configuración: ConfiguracionDelSistema
    -log_alertas: list[RegistroAlerta]

    +__init__(configuracion: ConfiguracionSistema)
    +agregar_sensor(sensor: Sensor): void
    +agregar_notificador(notificador: Notificador): void
    +evaluar_y_notificar(): void
    +generar_reporte(): String
    +limpiar_historico(): void
}

' Agregación - Sistema tiene GestorAlertas
class SistemaMonitoreo {
    -nombre: String
    -version: String
    -gestor_alertas: GestorAlertas
    -panel_control: PanelControl
    
    +__init__(nombre: String, version: String)
    +inicializar(): void
    +detener(): void
    +obtener_estado_general(): String
}

' Clase de configuración
class ConfiguracionSistema {
    +intervalo_verificacion: int
    +max_alertas_por_hora: int
    +nivel_log: String
    +ruta_logs: String
    
    +cargar_configuracion(archivo: String): void
    +guardar_configuracion(): void
    +validar_configuracion(): boolean
}

' Clase para registros 
class RegistroAlerta{
    +timestamp: DateTime
    +sensor_id: String
    +mensaje: String
    +nivel: String
    +valor_medido: float
    
    +__init__(sensor_id: String, mensaje: String, nivel: String, valor: float)
    +to_json(): String
    +to_csv(): String
}

' Clase para interfaz de usuario
class PanelDeControl{
    -sistema: SistemaMonitoreo
    -interfaz_activa: boolean
    
    +__init__(sistema: SistemaMonitoreo)
    +mostrar_dashboard(): void
    +procesar_comandos(): void
    +actualizar_interfaz(): void
}

' Factory para crear sensores
class SensorFactory{
    +crear_sensor_temperatura(id: String, umbral: float): SensorTemperatura
    +crear_sensor_vibracion(id: String, rms: float): SensorVibracion
    +crear_sensor_humedad(id: String, umbral: float): SensorHumedad
}

' -----------------------RELACIONES----------------------
' Herencia (Generalización)
Sensor <|-- SensorTemperatura : extends
Sensor <|-- SensorVibracion : extends  
Sensor <|-- SensorHumedad : extends

' Implementacion
Notificador <|.. NotificadorEmail : implements
Notificador <|.. NotificadorSMS : implements
Notificador <|.. NotificadorWebhook : implements

' Composición (rombo negro) - GestorAlertas CONTIENE sensores y notificadores
GestorAlertas *-- Sensor : contains
GestorAlertas *-- Notificador : contains
GestorAlertas *-- ConfiguracionSistema : contains
GestorAlertas *-- RegistroAlerta : contains

' Agregación (rombo blanco) - SistemaMonitoreo TIENE GestorAlertas
SistemaMonitoreo "1" o-- "1" GestorAlertas : has
SistemaMonitoreo "1" o-- "1" PanelDeControl : has

' Asociación - PanelDeControl conoce a SistemaMonitoreo
PanelDeControl --> SistemaMonitoreo : uses

' Dependencia (flecha punteada) - SensorFactory crea sensores
SensorFactory "1" ..> "0..*" SensorTemperatura : creates
SensorFactory "1" ..> "0..*" SensorVibracion : creates
SensorFactory "1" ..> "0..*" SensorHumedad : creates

@enduml