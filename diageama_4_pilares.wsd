@startuml diagrama_4_pilares
' Protocol/Interface
interface Notificador << (I,lightblue) Interface >> {
    +enviar(mensaje: String): void
}

' Implementaciones del Protocol / Interface
class NotificadorEmail {
    -destinatario: String
    -servidor_smtp: String
    +__init__(destinatario: String, servidor: String)
    +enviar(mensaje: String): void
    +validar_email(): boolean
}

class NotificadorWebhook {
    -url: String
    -timeout: int
    +__init__(url: String, timeout: int)
    +enviar(mensaje: String): void
    +validar_url(): boolean
}

class NotificadorSMS {
    -numero: String
    -proveedor: String
    +__init__(numero: String, proveedor: String)
    +enviar(mensaje: String): void
    +formato_numero(): String
}

' Clase abstracta base para los sensores
abstract class Sensor << (A,Orange) Abstract >> {
    +id: String
    +ventana: int
    #calibracion: float
    #buffer: list[float]
    #ubicacion: String

    +__init__(id: String, ventana: int, ubicacion: String)
    +leer(valor: float): void
    +promedio(): float
    +obtener_estado(): String
    {abstract} +en_alerta(): boolean
    {abstract} +obtener_tipo(): String
}


' HERENCIA: Subclases Concretas
class SensorTemperatura {
    -umbral_max: float
    -umbral_min: float
    -unidad: String

    +__init__(id: String, umbral_max: float, umbral_min: float)
    +en_alerta(): boolean
    +obtener_tipo(): String
    +celsius_to_fahrenheit(): float
}

class SensorVibracion {
    -rms_umbral: float
    -frecuencia: int

    +__init__(id: String, rms_umbral: float, frecuencia: int)
    +en_alerta(): boolean
    +obtener_tipo(): String
    +calcular_rms(): float
}

class SensorHumedad{
    -umbral_humedad: float
    -tipo_ambiente: String

    +__init__(id: String, umbral: float, ambiente: String)
    +en_alerta(): boolean
    +obtener_tipo(): String
    +calcular_punto_rocio(): float
}


' Composici√≥n - GestorAlertas contiene sensores y notificadores
class GestorAlertas {
    -sensores: list[Sensor]
    -notificadores: list[Notificador]
    -configuracion: ConfiguracionSistema
    -log_alertas: list[RegistroAlerta]

    +__init__(configuracion: ConfiguracionSistema)
    +agregar_sensor(sensor: Sensor): void
    +agregar_notificador(notificador: Notificador): void
    +evaluar_y_notificar(): void
    +generar_reporte(): String
    +limpiar_historico(): void
    +sensores(): list[Sensor]
}

' Agregaci√≥n - Sistema tiene GestorAlertas
class SistemaMonitoreo {
    -nombre: String
    -version: String
    -gestor_alertas: GestorAlertas
    -panel_control: PanelDeControl
    
    +__init__(nombre: String, version: String)
    +inicializar(): void
    +detener(): void
    +obtener_estado_general(): String
    +gestor_alertas(): GestorAlertas
    +panel_control(): PanelDeControl
}

' Clase de configuraci√≥n
class ConfiguracionSistema {
    +intervalo_verificacion: int
    +max_alertas_por_hora: int
    +nivel_log: String
    +ruta_logs: String

    +cargar_configuracion(archivo: String): void
    +guardar_configuracion(): void
    +validar_configuracion(): boolean
}

' Clase para registros
class RegistroAlerta{
    +timestamp: DateTime
    +sensor_id: String
    +mensaje: String
    +nivel: String
    +valor_medido: float

    +__init__(sensor_id: String, mensaje: String, nivel: String, valor: float)
    +to_json(): String
    +to_csv(): String
}

' Clase para interfaz de usuario
class PanelDeControl{
    -sistema: SistemaMonitoreo
    -interfaz_activa: boolean

    +__init__(sistema: SistemaMonitoreo)
    +limpiar_pantalla(): void
    +mostrar_dashboard(): void
    +mostrar_menu_principal(): void
    +procesar_comandos(): boolean
    +mostrar_estado_sistema(): void
    +generar_reporte_completo(): void
    +simular_lecturas(): void
    +evaluar_alertas(): void
    +configurar_sistema(): void
    +limpiar_historico(): void
    +gestionar_notificadores(): void
    +gestionar_sensores(): void
    +actualizar_interfaz(): void
}

' Factory para crear sensores
class SensorFactory{
    +crear_sensor_temperatura(id: String, umbral: float): SensorTemperatura
    +crear_sensor_vibracion(id: String, rms: float): SensorVibracion
    +crear_sensor_humedad(id: String, umbral: float): SensorHumedad
}

' ==================== FUNCI√ìN DE CONFIGURACI√ìN ====================
class ConfiguradorSistema << (F,lightgreen) Function >> {
    +configurar_sistema_inicial(sistema: SistemaMonitoreo): void
}

' -----------------------RELACIONES----------------------
' Herencia (Generalizaci√≥n)
Sensor <|-- SensorTemperatura : extends
Sensor <|-- SensorVibracion : extends
Sensor <|-- SensorHumedad : extends

' Implementacion
Notificador <|.. NotificadorEmail : implements
Notificador <|.. NotificadorSMS : implements
Notificador <|.. NotificadorWebhook : implements

' Composici√≥n (rombo negro) - GestorAlertas CONTIENE sensores y notificadores
GestorAlertas *-- Sensor : contains
GestorAlertas *-- Notificador : contains
GestorAlertas *-- ConfiguracionSistema : contains
GestorAlertas *-- RegistroAlerta : contains

' Agregaci√≥n (rombo blanco) - SistemaMonitoreo TIENE GestorAlertas
SistemaMonitoreo "1" o-- "1" GestorAlertas : has
SistemaMonitoreo "1" o-- "1" PanelDeControl : has

' Asociaci√≥n - PanelDeControl conoce a SistemaMonitoreo
PanelDeControl --> SistemaMonitoreo : uses

' Dependencia (flecha punteada) - SensorFactory crea sensores
SensorFactory "1" ..> "0..*" SensorTemperatura : creates
SensorFactory "1" ..> "0..*" SensorVibracion : creates
SensorFactory "1" ..> "0..*" SensorHumedad : creates
ConfiguradorSistema "1" ..> "0..*" SistemaMonitoreo : configures
ConfiguradorSistema "1" ..> "0..*" SensorFactory : uses

' ==================== NOTAS EXPLICATIVAS ====================
note right of Sensor : üé® ABSTRACCI√ìN:\nClase abstracta que define\nla interfaz com√∫n para\ntodos los sensores

note bottom of SensorTemperatura : üß¨ HERENCIA + üé≠ POLIMORFISMO:\nHereda de Sensor e implementa\nsu propia versi√≥n de en_alerta()

note left of GestorAlertas : üèóÔ∏è COMPOSICI√ìN:\nContiene y gestiona sensores,\nnotificadores y configuraci√≥n.\nSi se destruye, sus partes\ntambi√©n se destruyen.

note top of SistemaMonitoreo : ü§ù AGREGACI√ìN:\nTiene un GestorAlertas y\nPanelDeControl, pero pueden\nexistir independientemente.

note right of NotificadorEmail : üîí ENCAPSULACI√ìN:\nAtributos privados (_destinatario)\nprotegidos del acceso externo\ndirecto.

note bottom of PanelDeControl : üëã ASOCIACI√ìN:\nConoce y usa SistemaMonitoreo\npero no lo posee. Relaci√≥n\nde colaboraci√≥n.

note left of SensorFactory : üì¶ DEPENDENCIA:\nCrea instancias de sensores.\nDepende de las clases de\nsensores para funcionar.

' ==================== COLORES PARA MEJOR VISUALIZACI√ìN ====================
skinparam class {
    BackgroundColor<<Interface>> LightBlue
    BackgroundColor<<Abstract>> LightYellow
    BackgroundColor<<Function>> LightGreen
    BorderColor<<Interface>> Blue
    BorderColor<<Abstract>> Orange
}

' ==================== LEYENDA ====================
legend bottom left
    üé® **4 PILARES OOP IMPLEMENTADOS:**
    ‚Ä¢ üîí **Encapsulaci√≥n**: Atributos privados con _
    ‚Ä¢ üß¨ **Herencia**: Sensor ‚Üí SensorTemperatura/Vibracion/Humedad  
    ‚Ä¢ üé≠ **Polimorfismo**: Diferentes implementaciones de m√©todos
    ‚Ä¢ üé® **Abstracci√≥n**: Clases abstractas y protocolos
    
    **RELACIONES UML:**
    ‚Ä¢ ‚Äî‚Äî‚ñ∑ Herencia/Generalizaci√≥n
    ‚Ä¢ ‚ãØ‚ñ∑ Implementaci√≥n de Interface
    ‚Ä¢ ‚Äî‚Äî‚ô¶ Composici√≥n (contiene/posee)
    ‚Ä¢ ‚Äî‚Äî‚óá Agregaci√≥n (tiene/usa)
    ‚Ä¢ ‚Äî‚Äî‚Üí Asociaci√≥n (conoce/colabora)  
    ‚Ä¢ ‚ãØ‚Üí Dependencia (usa temporalmente)
end legend

@enduml